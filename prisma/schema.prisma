// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:../database/sqlite/dev.db"
}

model Member {
  id           Int            @id @default(autoincrement())
  name         String
  birth_date   DateTime
  batism_date  DateTime
  titleChurch  String
  cpf          BigInt         @unique
  rg           Int
  login        String
  email        String
  password     String
  foto         String?
  Manager      Manager[]
  Treasurer    Treasurer[]
  SpecialOffer SpecialOffer[]
  id_church    Int
  church       Church         @relation(fields: [id_church], references: [id])

  @@map("members")
}

model Manager {
  id        Int      @id @default(autoincrement())
  id_member Int
  member    Member   @relation(fields: [id_member], references: [id])
  id_church Int
  church    Church   @relation(fields: [id_church], references: [id])
  dateStart DateTime @default(now())
  dateEnd   DateTime?

  @@map("managers")
}

model Treasurer {
  id        Int      @id @default(autoincrement())
  startDate DateTime
  endDate   DateTime
  Offer     Offer[]
  id_member Int
  member    Member   @relation(fields: [id_member], references: [id])

  @@map("treasurers")
}

model Offer {
  id           Int            @id @default(autoincrement())
  value        Int
  SpecialOffer SpecialOffer[]
  id_treasurer Int
  treasurer    Treasurer      @relation(fields: [id_treasurer], references: [id])
  Cult         Cult[]

  @@map("offers")
}

model SpecialOffer {
  id        Int      @id @default(autoincrement())
  reason    String
  date      DateTime
  id_offer  Int
  offer     Offer    @relation(fields: [id_offer], references: [id])
  id_member Int
  member    Member   @relation(fields: [id_member], references: [id])
  id_church Int
  church    Church   @relation(fields: [id_church], references: [id])
  Tethe     Tethe[]

  @@map("special_offers")
}

model Tethe {
  id               Int          @id @default(autoincrement())
  salaryValue      Int
  id_special_offer Int
  specialOffer     SpecialOffer @relation(fields: [id_special_offer], references: [id])

  @@map("tethes")
}

model Church {
  id           Int            @id @default(autoincrement())
  creationDate DateTime
  Cult         Cult[]
  Cost         Cost[]
  id_location  Int
  location     Location       @relation(fields: [id_location], references: [id])
  SpecialOffer SpecialOffer[]
  Member       Member[]
  Manager      Manager[]

  @@map("churchs")
}

model Cult {
  id        Int      @id @default(autoincrement())
  date      DateTime
  theme     String
  id_offer  Int
  offer     Offer    @relation(fields: [id_offer], references: [id])
  id_church Int
  church    Church   @relation(fields: [id_church], references: [id])

  @@map("cults")
}

model Cost {
  id          Int      @id @default(autoincrement())
  value       Float
  date        DateTime
  description String
  id_church   Int
  church      Church   @relation(fields: [id_church], references: [id])

  @@map("costs")
}

model Location {
  id       Int      @id @default(autoincrement())
  street   String
  district String
  city     String
  state    String
  country  String
  cep      Int      @unique
  Church   Church[]

  @@map("locations")
}
